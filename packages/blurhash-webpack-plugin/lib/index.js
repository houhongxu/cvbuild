"use strict";var $=Object.create;var d=Object.defineProperty;var z=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var U=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var B=(t,a)=>{for(var e in a)d(t,e,{get:a[e],enumerable:!0})},x=(t,a,e,r)=>{if(a&&typeof a=="object"||typeof a=="function")for(let o of E(a))!k.call(t,o)&&o!==e&&d(t,o,{get:()=>a[o],enumerable:!(r=z(a,o))||r.enumerable});return t};var R=(t,a,e)=>(e=t!=null?$(U(t)):{},x(a||!t||!t.__esModule?d(e,"default",{value:t,enumerable:!0}):e,t)),V=t=>x(d({},"__esModule",{value:!0}),t);var G={};B(G,{default:()=>q});module.exports=V(G);var T=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"];var M=(t,a)=>{var e="";for(let r=1;r<=a;r++){let o=Math.floor(t)/Math.pow(83,a-r)%83;e+=T[Math.floor(o)]}return e},p=t=>{let a=t/255;return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)},w=t=>{let a=Math.max(0,Math.min(1,t));return a<=.0031308?Math.trunc(a*12.92*255+.5):Math.trunc((1.055*Math.pow(a,.4166666666666667)-.055)*255+.5)},j=t=>t<0?-1:1,g=(t,a)=>j(t)*Math.pow(Math.abs(t),a),y=class extends Error{constructor(t){super(t),this.name="ValidationError",this.message=t}};var P=4,F=(t,a,e,r)=>{let o=0,h=0,s=0,i=a*P;for(let f=0;f<a;f++){let c=P*f;for(let n=0;n<e;n++){let u=c+n*i,m=r(f,n);o+=m*p(t[u]),h+=m*p(t[u+1]),s+=m*p(t[u+2])}}let l=1/(a*e);return[o*l,h*l,s*l]},H=t=>{let a=w(t[0]),e=w(t[1]),r=w(t[2]);return(a<<16)+(e<<8)+r},L=(t,a)=>{let e=Math.floor(Math.max(0,Math.min(18,Math.floor(g(t[0]/a,.5)*9+9.5)))),r=Math.floor(Math.max(0,Math.min(18,Math.floor(g(t[1]/a,.5)*9+9.5)))),o=Math.floor(Math.max(0,Math.min(18,Math.floor(g(t[2]/a,.5)*9+9.5))));return e*19*19+r*19+o},N=(t,a,e,r,o)=>{if(r<1||r>9||o<1||o>9)throw new y("BlurHash must have between 1 and 9 components");if(a*e*4!==t.length)throw new y("Width and height must match the pixels array");let h=[];for(let n=0;n<o;n++)for(let u=0;u<r;u++){let m=u==0&&n==0?1:2,D=F(t,a,e,(I,O)=>m*Math.cos(Math.PI*u*I/a)*Math.cos(Math.PI*n*O/e));h.push(D)}let s=h[0],i=h.slice(1),l="",f=r-1+(o-1)*9;l+=M(f,1);let c;if(i.length>0){let n=Math.max(...i.map(m=>Math.max(...m))),u=Math.floor(Math.max(0,Math.min(82,Math.floor(n*166-.5))));c=(u+1)/166,l+=M(u,1)}else c=1,l+=M(0,1);return l+=M(H(s),4),i.forEach(n=>{l+=M(L(n,c),2)}),l},A=N;var C=R(require("sharp")),v="ImageOptimizerWebpackPlugin",W=async t=>{let a=(0,C.default)(t).raw().ensureAlpha(),{width:e=0,height:r=0}=await a.metadata(),{data:o,info:h}=await a.resize({width:16}).toBuffer({resolveWithObject:!0}),s=new Uint8Array(o.buffer),i=new Uint8ClampedArray(s.buffer),l=A(i,h.width,h.height,4,4);return{width:e,height:r,blurhash:encodeURIComponent(l)}},b=class{apply(a){a.hooks.thisCompilation.tap(v,e=>{e.hooks.finishModules.tapPromise(v,async()=>{let r={},o=Array.from(e.modules).map(async h=>{if(h.type==="asset/resource"){let s=h.libIdent({context:a.options.context||""});if(s){let i=await W(s);r[s]=i}}});await Promise.all(o),a.options.output.assetModuleFilename=h=>{let{width:s,height:i,blurhash:l}=r[`./${h.filename}`];return`[hash][ext]?width=${s}&height=${i}&blurhash=${l}`}})})}},q=b;
